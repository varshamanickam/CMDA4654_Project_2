---
title: "Multinomial Regression"
author: "Chris Ryan, Jeb Brown, Varsha Manickam, Meghna Kommoju, Zhennan Shen"
date: "2025-04-15"
fontsize: 9pt
classoption: "aspectratio=169"
output: 
  beamer_presentation: 
    fonttheme: professionalfonts
    highlight: kate
    theme: Rochester
header-includes:
- \definecolor{VTmaroon}{HTML}{861F41}
- \usecolortheme[named=VTmaroon]{structure}
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE,
                      comment = NA)

def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  paste0("\n \\", "footnotesize","\n\n", x, "\n\n \\normalsize")
})


```

## Multinomial Regression

Multinomial Regression (also called Multinomial Logistic Regression) is a classification method that is used to predict nominal outcome variables that have more than two outcomes (polytomous) that do not have a rank or order.
Examples of this would be:

- Classifying flower species (setosa, virginica, veritosa)
- Classifying student programs (academic, vocation, general)
- Classifying student majors (engineering, business, science)

## Assumptions for Multinomial Regression

- Independence of observations
- Categories of the outcome variable must be mutually exclusive and exhaustive
- No multicollinearity between independent variables
- Linear relationship between continuous variables and the logit transformation of the outcome variable

## Theory


## Small example

## Main example

```{r}
library(nnet)
library(caret)
library(readr)
library(dplyr)

data <- read_csv("steel_faults.csv")

# We need to combine the various fault columns into one column, and get rid of the separate columns
data <- data %>%
  mutate(Fault_Type = case_when(
    Pastry == 1 ~ "Pastry",
    Z_Scratch == 1 ~ "Z_Scratch",
    K_Scatch == 1 ~ "K_Scatch",
    Stains == 1 ~ "Stains",
    Dirtiness == 1 ~ "Dirtiness",
    Bumps == 1 ~ "Bumps",
    Other_Faults == 1 ~ "Other"
  )) %>%
  select(-Pastry, -Z_Scratch, -K_Scatch, -Stains, -Dirtiness, -Bumps, -Other_Faults)

# We need to convert the targets to factors since we are dealing with categories
data$Fault_Type <- as.factor(data$Fault_Type)

# Fitting the multinomial model to the data
model <- multinom(Fault_Type ~ ., data = data)

# Find predicted values that the model suggests
predicted <- predict(model, newdata = data)

```

## Confusion Matrix and Interpretations

```{r}
# Confusion matrix
cm <- confusionMatrix(predicted, data$Fault_Type)
cm$table
```

